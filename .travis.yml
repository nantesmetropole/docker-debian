language: generic
sudo: required
services:
  - docker

env:
    matrix:
        - DEBOOTSTRAP_FORCE_GPG_CHECK=no DIST=wheezy
        - DEBOOTSTRAP_FORCE_GPG_CHECK=no DIST=jessie
        - DEBOOTSTRAP_FORCE_GPG_CHECK=no DIST=stretch

before_install:
    - sudo apt-get update -qq
    - sudo apt-get install -qq debootstrap
    - sudo ln -s sid /usr/share/debootstrap/scripts/stretch # debootstrap too old
script:
    - make image && make test
after_success:
  - if [ "$TRAVIS_BRANCH" == "master" ]; then
    docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD";
    make push;
    fi
